define("modules/advanced_filter/advanced_filter",["require"],function(e){function t(){if(page.comm.searchTool&&("en"===page.comm.searchTool.sl_lang||"none"!==page.comm.searchTool.timeTag||R)){n();var e="";"en"===page.comm.searchTool.sl_lang&&(e+='<input type="hidden" name="sl_lang" value="en"><input type="hidden" name="rsv_srlang" value="en">'),"none"!==page.comm.searchTool.timeTag&&(e+='<input type="hidden" name="gpc" value="'+page.comm.searchTool.gpc+'">'),
R&&(e+='<input type="hidden" name="si" value="'+page.comm.searchTool.si+'">'),$(".se-form").append(e)}$(".advanced-filter").on("click",function(){i(),page.log.send({ct:70,cst:0})})}function n(){$(".advance-filter-hint-button").on("click",function(){i(),page.log.send({ct:70,cst:0}),a()}),$(".advance-filter-hint i").on("click",function(){$(".advance-filter-hint").remove(),page.log.send({ct:70,cst:10}),I=page.utils.link.getSearchUrl(decodeURIComponent(page.comm.query),{}),window.location.href=I})}
function i(){0===$(".filter-panel-wrapper").length?(l(),v=$(".filter-panel-wrapper"),S=$(".filter-panel-close"),b=$(".filter-panel-mask"),T=$(".filter-panel-site-row>.filter-panel-item"),w=$(".filter-panel-time-row>.filter-panel-item"),y=$(".filter-panel-lang-row>.filter-panel-item"),x=$(".filter-panel-reset"),k=$(".filter-panel-confirm"),C=$(".filter-panel-site-input>input"),q=$(".filter-panel-site-warn"),_=$(".filter-panel-site-input-close")):(v.show(),b.show()),u(!0),a()}function l(){
$(".filter-panel-wrapper")&&$(".filter-panel-wrapper").remove(),$(".filter-panel-mask")&&$(".filter-panel-mask").remove();if(page.comm.searchTool&&void 0!==page.comm.searchTool.si)var e={title:"高级筛选",site:["百家号","百度知道","百度贴吧","百度经验","作业帮","知乎","爱奇艺","百度文库"],time:["一天内","一周内","一个月内","一年内"],lang:["英文结果"]};else var e={title:"高级筛选",time:["一天内","一周内","一个月内","一年内"],lang:["英文结果"]};""===page.comm.searchTool.sl_lang&&(e.lang=null)
;var t=page.etpl.compile('<style>\n.filter-panel-wrapper {\n\tposition: fixed;\n\ttop:0;\n    width: 100%;\n    max-height: 100%;\n    overflow-y: auto;\n    overflow-x: hidden;\n    background: #fff;\n    z-index: 302;\n}\n\n@media (max-width: 320px) {\n\t.filter-panel-filter-content {\n\t\tpadding-bottom: .05rem;\n\t}\n}\n.filter-panel-title {\n\theight: .44rem;\n\ttext-align: center;\n\tfont-size: .16rem;\n\tline-height: .44rem;\n}\n.filter-panel-title span:first-child {\n\tdisplay: inline-block;\n\theight: .44rem;\n\tline-height: .44rem;\n\tfont-size: .18rem;\n\tfont-weight: bold;\n}\n.filter-panel-close {\n\tposition: absolute;\n    top: 1px;\n    right: .17rem;\n}\n.filter-panel-gap {\n\tpadding-left: .17rem;\n\tpadding-right: .17rem;\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.filter-panel-category {\n\theight: .44rem;\n\tline-height: .44rem;\n\twidth: 100%;\n\ttext-align: left;\n\tmargin-left: .17rem;\n}\n.filter-panel-item {\n\tbackground: #f8f8f8;\n\tborder-radius: 3px;\n\theight: .38rem;\n\tline-height: .38rem;\n\tmargin-right: .08rem;\n\t-webkit-tap-highlight-color: transparent;\n}\n.filter-panel-item span {\n\tdisplay: inline-block;\n\twidth: 100%;\n\theight: .36rem;\n\t-webkit-tap-highlight-color: transparent;\n}\n\n.filter-panel-item i {\n\tposition: absolute;\n\tright: 0;\n\tbottom: 0;\n\tdisplay: none;\n}\n\n.filter-panel-item:last-child {\n\tmargin-right: 0;\n}\n\n.filter-panel-mask {\n\twidth: 100%;\n\theight: 100%;\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tbackground: rgba(0,0,0,.5);\n\tz-index: 98;\n}\n.filter-panel-choose {\n\tpadding-left: .17rem;\n\tpadding-right: .17rem;\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n.filter-panel-reset {\n\tborder: 1px solid #707379;\n\tborder-radius: 3px;\n\theight: .38rem;\n\tline-height: .38rem;\n\tmargin-right: .08rem;\n}\n.filter-panel-confirm {\n\tbackground: #555;\n\tcolor: #fff;\n\tborder-radius: 3px;\n\theight: .38rem;\n\tline-height: .38rem;\n}\n.filter-panel-item-seleted {\n\tbackground: #fff;\n\tborder: 1px solid #555;\n\tline-height: .36rem;\n\tposition: relative;\n}\n.filter-panel-item-seleted i {\n\tposition: absolute;\n    font-size: .08rem;\n    right: 1px;\n    bottom: 0px;\n    color: #fff;\n    z-index: 99;\n    width: 8px;\n    height: 8px;\n    line-height: 8px;\n    display: block;\n}\n\n.filter-panel-item-seleted:after {\n\tcontent: \'\';\n    display: block;\n    position: absolute;\n    right: 0px;\n    bottom: 0px;\n    border-width: 8px;\n    border-style: solid;\n    border-color: transparent #555 #555 transparent;\n}\n.filter-panel-site-search {\n\tpadding-left: .17rem;\n\tpadding-right: .17rem;\n}\n.filter-panel-site-row {\n\tmargin-bottom: .08rem;\n}\n.filter-panel-site-warn {\n\tmargin-top: .1rem;\n\tline-height: 1;\n\ttext-align: left;\n\tcolor: #d00000;\n}\n.filter-panel-site-input {\n\tposition: relative;\n}\n.filter-panel-site-input input {\n\tpadding-right: .3rem;\n}\n@media (max-width: 320px) {\n\t.filter-panel-site-input input {\n\t\tline-height: .39rem;\n\t}\n}\n.filter-panel-site-input-close {\n\tposition: absolute;\n\tfont-size: .18rem;\n    color: #ccc;\n    right: .08rem;\n    top: .09rem;\n    display: none;\n}\n.filter-panel-site-warn {\n\tdisplay: none;\n}\n</style>\n<div class="filter-panel-wrapper">\n\t<div class="filter-panel-title c-line-bottom">\n\t\t<span class="c-color-link">${title}</span>\n\t\t<span class="filter-panel-close c-color-gray-a">关闭</span>\n\t</div>\n\t<div class="filter-panel-filter-content c-line-bottom c-gap-bottom-large">\n\t\t<%if: ${site}%>\n\t\t<div class="filter-panel-site">\n\t\t\t<div class="filter-panel-category c-color">站点筛选</div>\n\t\t\t<%for: ${site} as ${item},${index}%>\n\t\t\t\t<%if: ${index}%4 == 0%>\n\t\t\t\t<div class="filter-panel-site-row c-row filter-panel-gap">\n\t\t\t\t<%/if%>\n\t\t\t\t\t<div class="c-span3 filter-panel-item c-gap-right-middle"><span>${item}</span><i class="c-icon">&#xe608</i></div>\n\t\t\t\t<%if: ${index}%4 == 3%>\n\t\t\t\t</div>\n\t\t\t\t<%/if%>\n\t\t\t<%/for%>\n\t\t\t<div class="c-row c-gap-top-large filter-panel-site-search">\n    \t\t\t<div class="c-span12">\n        \t\t\t<div class="filter-panel-site-input"><input class="c-input c-icon" type="text" placeholder="&#xe641 您也可以输入域名搜索，如：baidu.com"><i class="filter-panel-site-input-close c-icon">&#xe601</i></div>\n        \t\t\t<div class="filter-panel-site-warn">请输入正确内容，如：baidu.com</div>\n    \t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<%/if%>\n\t\t<%if: ${lang}%>\n\t\t<div class="filter-panel-time">\n\t\t<%else%>\n\t\t<div class="filter-panel-time c-gap-bottom-large">\n\t\t<%/if%>\n\t\t\t<div class="filter-panel-category c-color">时间范围</div>\n\t\t\t<div class="filter-panel-time-row c-row filter-panel-gap">\n\t\t\t\t<%for: ${time} as ${item},${index}%>\n\t\t\t\t\t<div class="c-span3 filter-panel-item c-gap-right-middle"><span>${item}</span><i class="c-icon">&#xe608</i></div>\n\t\t\t\t<%/for%>\n\t\t\t</div>\n\t\t</div>\n\t\t<%if: ${lang}%>\n\t\t<div class="filter-panel-lang c-gap-bottom-large">\n\t\t\t<div class="filter-panel-category c-color">语言类型</div>\n\t\t\t<div class="filter-panel-lang-row c-row filter-panel-gap">\n\t\t\t\t<div class="c-span3 filter-panel-item"><span>${lang}</span><i class="c-icon">&#xe608</i></div>\n\t\t\t\t<div class="c-span3 c-gap-right-middle"></div>\n\t\t\t\t<div class="c-span3 c-gap-right-middle"></div>\n\t\t\t\t<div class="c-span3"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<%/if%>\n\t</div>\n\t<div class="filter-panel-choose c-row c-gap-bottom-large filter-panel-gap">\n\t\t<div class="c-span6 filter-panel-reset">重置</div>\n\t\t<div class="c-span6 filter-panel-confirm">确定</div>\n\t</div>\n</div>\n<div class="filter-panel-mask"></div>')(e)
;if($("body").prepend(t),"en"===page.comm.searchTool.sl_lang&&($(".filter-panel-lang-row>.filter-panel-item").addClass("filter-panel-item-seleted"),U.langSeletedItem="en"),page.comm.searchTool.timeType){var n=page.comm.searchTool.timeType;$(".filter-panel-time-row > .filter-panel-item").each(function(e){n===$(this).children("span").text()&&($(this).addClass("filter-panel-item-seleted"),U.timeSeletedItem=n)})}if(page.comm.searchTool.siteType){var i=page.comm.searchTool.siteType,l=!1
;$(".filter-panel-site .filter-panel-item").each(function(){i===$(this).children("span").text()&&($(this).addClass("filter-panel-item-seleted"),l=!0),U.siteSeletedItem=i}),l||($(".filter-panel-site-input>input").attr("value",i),U.siteSeletedItem=i)}}function a(){if(b.off("click").on("click",r),S.off("click").on("click",r),x.on("click",function(){$(".filter-panel-item-seleted").length>0&&$(".filter-panel-item-seleted").removeClass("filter-panel-item-seleted"),C.val(""),U.queryString={},
U.langSeletedItem="cn",U.timeSeletedItem="时间不限",U.siteSeletedItem="",page.log.send({ct:70,cst:2})}),page.comm.searchTool&&void 0!==page.comm.searchTool.si){T.off("click").on("click",function(e){o(e)});var e=!1;if(navigator.userAgent.indexOf("Safari")>-1)var t="safari";"safari"==t&&C.on("click",function(e){$("html").scrollTop(0),$("body").scrollTop(0),$(window).scrollTop(0),$(".filter-panel-wrapper").css("position","absolute")}),C.on("focus",function(t){
$(".filter-panel-site").find(".filter-panel-item-seleted")&&$(".filter-panel-site").find(".filter-panel-item-seleted").removeClass("filter-panel-item-seleted"),_.show(),_.on("click",function(t){e=!0,C.val("").focus(),$(this).hide(),U.siteSeletedItem="",t.preventDefault(),t.stopPropagation()})});var n;C.on("blur",function(){clearTimeout(n),n=setTimeout(function(){0==e&&_.hide(),e=!1},0),"safari"==t&&$(".filter-panel-wrapper").css("position","fixed")})}w.off("click").on("click",function(e){s(e)}),
y.off("click").on("click",function(e){page.log.send({ct:70,cst:4}),c(e)}),k.off("click").on("click",function(){p()})}function r(){v.hide(),b.hide(),u(!1),page.log.send({ct:70,cst:1})}function o(e){var t=$(e.target).parent(".filter-panel-item");if(t.hasClass("filter-panel-item-seleted"))return t.removeClass("filter-panel-item-seleted"),void(U.siteSeletedItem="");$(".filter-panel-site-row").find(".filter-panel-item-seleted").removeClass("filter-panel-item-seleted"),
t.addClass("filter-panel-item-seleted"),C.val(""),U.siteSeletedItem=t.children("span").text()}function s(e){var t=$(e.target).parent(".filter-panel-item");if(t.hasClass("filter-panel-item-seleted"))return t.removeClass("filter-panel-item-seleted"),void(U.timeSeletedItem="时间不限");$(".filter-panel-time-row").find(".filter-panel-item-seleted").removeClass("filter-panel-item-seleted"),-1!==t.text().indexOf("一天内")?page.log.send({ct:70,cst:5}):-1!==t.text().indexOf("一周内")?page.log.send({ct:70,cst:6
}):-1!==t.text().indexOf("一个月内")?page.log.send({ct:70,cst:7}):-1!==t.text().indexOf("一年内")&&page.log.send({ct:70,cst:8}),t.addClass("filter-panel-item-seleted"),U.timeSeletedItem=t.children("span").text()}function c(e){var t=$(e.target).parent(".filter-panel-item");if(t.hasClass("filter-panel-item-seleted"))return t.removeClass("filter-panel-item-seleted"),void(U.langSeletedItem="cn");t.addClass("filter-panel-item-seleted"),U.langSeletedItem="en"}function p(e){
U.queryString.sa||(U.queryString.sa="searchTool");$(".filter-panel-time-row").find(".filter-panel-item-seleted").length,$(".filter-panel-lang-row").find(".filter-panel-item-seleted").length;if(page.comm.searchTool&&void 0!==page.comm.searchTool.si){var t=$(".filter-panel-site-row").find(".filter-panel-item-seleted").length,n=C.val();if(""==C.val()&&0==t)U.siteSeletedItem="";else if(""!=C.val()){if(!n.match(/^[\w\-_]+(\.[\w\-_]+)+$/))return $(".filter-panel-site-warn").show(),void page.log.send({
ct:70,cst:11});U.siteSeletedItem=n,g("si",n,"inputSite"),$(".filter-panel-site-warn").hide(),m(U.queryString)}else if(""==C.val()&&0!=t){switch(U.siteSeletedItem=$(".filter-panel-site").find(".filter-panel-item-seleted").children("span").text(),U.siteSeletedItem){case"百家号":g("si","baijiahao.baidu.com","tagSite");break;case"百度知道":g("si","zhidao.baidu.com","tagSite");break;case"百度贴吧":g("si","tieba.baidu.com","tagSite");break;case"百度经验":g("si","jingyan.baidu.com","tagSite");break;case"作业帮":
g("si","zuoyebang.com","tagSite");break;case"知乎":g("si","zhihu.com","tagSite");break;case"爱奇艺":g("si","iqiyi.com","tagSite");break;case"百度文库":g("si","wenku.baidu.com","tagSite");break;default:U.siteSeletedItem=""}m(U.queryString)}}var i=!1,l=!1;if(U.timeSeletedItem===page.comm.searchTool.timeType&&(i=!0),U.langSeletedItem!==page.comm.searchTool.sl_lang&&""!==page.comm.searchTool.sl_lang||(l=!0),i&&l&&void 0===page.comm.searchTool.si)return v.hide(),b.hide(),void page.log.send({ct:70,cst:1})
;if("时间不限"===U.timeSeletedItem&&"cn"===U.langSeletedItem&&""===U.siteSeletedItem&&""===C.val())return I=page.utils.link.getSearchUrl(decodeURIComponent(page.comm.query),{}),void(window.location.href=I)
;if("时间不限"!==U.timeSeletedItem)if("一天内"===U.timeSeletedItem)f("gpc","stf="+page.comm.searchTool.oneDay+","+page.comm.searchTool.listTime+"|stftype=1","一天内",1,"thisday");else if("一周内"===U.timeSeletedItem)f("gpc","stf="+page.comm.searchTool.oneWeek+","+page.comm.searchTool.listTime+"|stftype=1","一周内",2,"thisweek");else if("一个月内"===U.timeSeletedItem)f("gpc","stf="+page.comm.searchTool.oneMonth+","+page.comm.searchTool.listTime+"|stftype=1","一月内",3,"thismonth");else{
if("一年内"!==U.timeSeletedItem)return;f("gpc","stf="+page.comm.searchTool.oneYear+","+page.comm.searchTool.listTime+"|stftype=1","一年内",4,"thisyear")}"cn"!==U.langSeletedItem&&d("sl_lang","en","英文结果"),page.log.send({ct:70,cst:3}),m(U.queryString)}function m(e){
page.comm.searchTool.st&&page.comm.searchTool.et&&page.comm.searchTool.stftype&&"时间不限"!==U.timeSeletedItem&&(e.gpc||(e.gpc=encodeURIComponent("stf="+page.comm.searchTool.st+","+page.comm.searchTool.et+"|stftype="+page.comm.searchTool.stftype))),page.comm.searchTool.sl_lang&&"cn"!==U.langSeletedItem&&(e.sl_lang||(e.rsv_srlang=encodeURIComponent(page.comm.searchTool.sl_lang),e.sl_lang=encodeURIComponent(page.comm.searchTool.sl_lang),e.rsv_rq=encodeURIComponent(page.comm.searchTool.sl_lang))),
I=page.utils.link.getSearchUrl(decodeURIComponent(page.comm.query),e),window.location.href=I}function d(e,t,n){e&&t&&n&&(U.queryString.rsv_srlang=encodeURIComponent(t),U.queryString.rsv_rq=encodeURIComponent(t),U.queryString[e]=encodeURIComponent(t),U.queryString.sa+="_"+t,U.queryString.ms="1")}function f(e,t,n,i,l){if(-1!==t.indexOf("="))var a=1;else var a=0;U.queryString[e]=encodeURIComponent(t),U.queryString.tfflag=a,U.queryString.sa+="_"+l,U.queryString.ms="1"}function g(e,t,n){
t&&(U.queryString[e]=encodeURIComponent(t),U.queryString.ms="1",U.queryString.sa+="_"+n)}function h(){$(".advanced-filter").off(),$(".filter-panel-wrapper").remove(),$(".filter-panel-mask").remove(),$(".advance-filter-hint").remove()}function u(e){e&&!page.comm.ishome?($(".filter-panel-wrapper").css("height","100%"),$("#page").css("position","fixed")):($(".filter-panel-wrapper").css("height",""),$("#page").css("position","relative"))}var v,S,w,y,T,b,x,k,I,C,q,_,U={};U.timeSeletedItem="时间不限",
U.langSeletedItem="cn",U.siteSeletedItem="",U.queryString={},U.queryString.sa="searchTool",page.comm=page.comm||{},page.comm.searchTool=page.comm.searchTool||"";var R=page.comm.searchTool&&page.comm.searchTool.si&&""!==page.comm.searchTool.si;return{init:t,destroy:h}});